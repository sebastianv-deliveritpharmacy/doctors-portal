import{v as B,H as V,r as d,R as F,e as H,c as R,i as t,w as s,u as l,k as _,h as j,o as G,q as C,a as r,S as L,m as f,A as y,B as g,T as Y,G as S,U as q,s as K,x as O,z as u,X,Y as Z,Z as A,K as J,V as Q}from"./index-CIon11F2.js";import{a as W,u as ee,c as te}from"./shipment-CREcLUiF.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-D3XPDuSg.js";const le={class:"dashboard-container"},ne={class:"greeting-card-content"},ie={class:"greeting-left"},se={class:"table-responsive"},re={__name:"DoctorPrescriptionsView",setup(oe){const I=V(),c=B(),k=I.params.id,w=d("Doctor"),x=d([]),N=d(0),p=d(!1),a=d({id:null,name:"",status:"",patient_name:"",shipment_id:"",rx_number:"",date_shipped:null,delivered_at:null,updated_at:null}),D=d(!1),h=d(""),v=d(1),b=d(10);F([h,v,b],()=>{m()});const M=[{label:"Confirmed Prescription Received",value:"confirmed_prescription_received"},{label:"Data Entry",value:"data_entry"},{label:"Intake Processing",value:"intake_processing"},{label:"Insurance Verification & Authorization",value:"insurance_verification"},{label:"Co-pay Assistant or Foundation Assistant",value:"copay_assistant"},{label:"Production",value:"production"},{label:"Collecting Co-pay",value:"collecting_copay"},{label:"Delivery Confirmation",value:"delivery_confirmation"}],U=()=>{a.value={id:null,name:"",status:"",patient_name:"",shipment_id:"",rx_number:"",date_shipped:null,activated_at:null},p.value=!0},z=i=>{a.value={...i},p.value=!0},T=async()=>{try{if(a.value.date_shipped&&a.value.delivered_at&&new Date(a.value.delivered_at).getTime()<=new Date(a.value.date_shipped).getTime()){c.error("Delivered time must be after the shipped time.");return}const i={user_id:k,patient_name:a.value.patient_name,prescription_name:a.value.name,status:a.value.status,rx_number:a.value.rx_number,shipment_id:a.value.shipment_id||null,date_shipped:a.value.date_shipped?P(a.value.date_shipped):null,delivered_at:a.value.delivered_at?P(a.value.delivered_at):null};a.value.id?(await ee(a.value.id,i),c.success("Shipment updated!")):(await te(i),c.success("Shipment created!")),p.value=!1,m()}catch(i){console.error("Error saving shipment:",i),c.error("Could not save shipment.")}};function P(i){const e=new Date(i),o=n=>n.toString().padStart(2,"0");return`${e.getFullYear()}-${o(e.getMonth()+1)}-${o(e.getDate())} ${o(e.getHours())}:${o(e.getMinutes())}:${o(e.getSeconds())}`}const m=async()=>{try{D.value=!0;const i=await W(k,v.value,b.value,h.value);w.value=i.doctorName||"Doctor",x.value=i.data.data.map(e=>({id:e.id,name:e.prescription_name||"-",status:e.status||"unknown",date_shipped:e.date_shipped?new Date(e.date_shipped).getTime():null,delivered_at:e.delivered_at?new Date(e.delivered_at).getTime():null,patient_name:e.patient_name||"-",shipment_id:e.shipment_id||"-",rx_number:e.rx_number||"-"})),N.value=i.data.total}catch(i){console.error("Error fetching shipments:",i),c.error("Unable to load shipment updates.")}finally{D.value=!1}};H(m);const $=[{title:"ID",key:"id"},{title:"Shipment ID",key:"shipment_id"},{title:"Patient",key:"patient_name"},{title:"Prescription",key:"name"},{title:"Status",key:"status",render:i=>{const e={confirmed_prescription_received:"info",data_entry:"default",intake_processing:"warning",insurance_verification:"warning",copay_assistant:"info",production:"primary",collecting_copay:"warning",delivery_confirmation:"success"},o={confirmed_prescription_received:"Confirmed Prescription Received",data_entry:"Data Entry",intake_processing:"Intake Processing",insurance_verification:"Insurance Verification & Authorization",copay_assistant:"Co-pay Assistant or Foundation Assistant",production:"Production",collecting_copay:"Collecting Co-pay",delivery_confirmation:"Delivery Confirmation"},n=e[i.status]||"default",E=o[i.status]||i.status;return S(Q,{type:n},{default:()=>E})}},{title:"Shipped At",key:"date_shipped",render:i=>i.date_shipped?new Date(i.date_shipped).toLocaleString():"—"},{title:"Delivered At",key:"delivered_at",render:i=>i.delivered_at?new Date(i.delivered_at).toLocaleString():"—"},{title:"Actions",key:"actions",render:i=>S("div",{style:"display: flex; gap: 8px;"},[S(g,{size:"small",type:"info",secondary:!0,onClick:()=>z(i)},{default:()=>"Edit"})])}];return(i,e)=>{const o=j("n-grid-item");return G(),R("div",le,[t(l(_),{vertical:"",size:"large"},{default:s(()=>[t(l(C),{class:"greeting-card"},{default:s(()=>[r("div",ne,[r("div",ie,[t(l(L),{label:"",value:`You are currently viewing ${w.value}`},null,8,["value"]),e[14]||(e[14]=r("div",{class:"subtext"},"These are the prescriptions associated with this doctor",-1))]),e[15]||(e[15]=r("div",{class:"greeting-right"},[r("span",{class:"help-title"},"Need help? Contact us:"),r("ul",{class:"help-list"},[r("li",null,[f("Phone: "),r("a",{href:"tel:+11231231233"},"832-939-8137")]),r("li",null,"Fax: 832 939 8128")])],-1))])]),_:1}),t(l(C),null,{default:s(()=>[t(l(_),{justify:"space-between",align:"center",style:{"margin-bottom":"16px"}},{default:s(()=>[t(l(y),{value:h.value,"onUpdate:value":e[0]||(e[0]=n=>h.value=n),placeholder:"Search prescriptions or patients...",clearable:"",style:{"max-width":"300px"}},null,8,["value"]),t(l(_),{justify:"space-between",align:"center"},{default:s(()=>[t(l(g),{type:"primary",onClick:e[1]||(e[1]=n=>i.$router.push("/dashboard/doctors"))},{default:s(()=>e[16]||(e[16]=[f(" Go Back ")])),_:1,__:[16]}),t(l(g),{type:"primary",onClick:U},{default:s(()=>e[17]||(e[17]=[f(" Add Prescription ")])),_:1,__:[17]})]),_:1})]),_:1}),r("div",se,[t(l(Y),{columns:$,data:x.value,bordered:!0,loading:D.value},null,8,["data","loading"])]),t(l(_),{justify:"end",style:{"margin-top":"16px"}},{default:s(()=>[t(l(q),{page:v.value,"onUpdate:page":[e[2]||(e[2]=n=>v.value=n),e[4]||(e[4]=n=>{v.value=n,m()})],"page-size":b.value,"item-count":N.value,"show-size-picker":"","page-sizes":[5,10,20],"onUpdate:pageSize":e[3]||(e[3]=n=>{b.value=n,v.value=1,m()})},null,8,["page","page-size","item-count"])]),_:1})]),_:1}),t(l(K),{show:p.value,"onUpdate:show":e[13]||(e[13]=n=>p.value=n),preset:"card",style:{width:"500px"}},{header:s(()=>[r("h2",null,J(a.value.id?"Edit Prescription":"Create Prescription"),1)]),default:s(()=>[t(l(O),null,{default:s(()=>[t(l(u),{label:"Patient Name"},{default:s(()=>[t(l(y),{value:a.value.patient_name,"onUpdate:value":e[5]||(e[5]=n=>a.value.patient_name=n),placeholder:"Patient Name"},null,8,["value"])]),_:1}),t(l(u),{label:"Prescription Name"},{default:s(()=>[t(l(y),{value:a.value.name,"onUpdate:value":e[6]||(e[6]=n=>a.value.name=n),placeholder:"Prescription Name"},null,8,["value"])]),_:1}),t(l(u),{label:"Rx Number"},{default:s(()=>[t(l(y),{value:a.value.rx_number,"onUpdate:value":e[7]||(e[7]=n=>a.value.rx_number=n),placeholder:"Rx Number"},null,8,["value"])]),_:1}),t(l(u),{label:"Shipment ID"},{default:s(()=>[t(l(y),{value:a.value.shipment_id,"onUpdate:value":e[8]||(e[8]=n=>a.value.shipment_id=n),placeholder:"Shipment ID"},null,8,["value"])]),_:1}),t(l(u),{label:"Status",path:"status"},{default:s(()=>[t(l(X),{value:a.value.status,"onUpdate:value":e[9]||(e[9]=n=>a.value.status=n),options:M,placeholder:"Select a status",clearable:""},null,8,["value"])]),_:1}),t(l(Z),{cols:2,"x-gap":12},{default:s(()=>[t(o,null,{default:s(()=>[t(l(u),{label:"Date Shipped"},{default:s(()=>[t(l(A),{value:a.value.date_shipped,"onUpdate:value":e[10]||(e[10]=n=>a.value.date_shipped=n),type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Select date & time",clearable:""},null,8,["value"])]),_:1})]),_:1}),t(o,null,{default:s(()=>[t(l(u),{label:"Deliverted At"},{default:s(()=>[t(l(A),{value:a.value.delivered_at,"onUpdate:value":e[11]||(e[11]=n=>a.value.delivered_at=n),type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"Select date & time",clearable:""},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(l(_),{justify:"end",class:"mt-4"},{default:s(()=>[t(l(g),{onClick:e[12]||(e[12]=n=>p.value=!1)},{default:s(()=>e[18]||(e[18]=[f("Cancel")])),_:1,__:[18]}),t(l(g),{type:"primary",onClick:T},{default:s(()=>e[19]||(e[19]=[f("Save")])),_:1,__:[19]})]),_:1})]),_:1})]),_:1},8,["show"])]),_:1})])}}},ce=ae(re,[["__scopeId","data-v-f0539a4c"]]);export{ce as default};
