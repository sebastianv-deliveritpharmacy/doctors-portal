import{i as U}from"./axios-D3XPDuSg.js";import{u as q,r as i,y as E,W as R,I as g,B as v,X as A,H as S,e as H,f as O,w as n,g as l,s as W,o as X,j as t,a as F,l as N,D as c,n as z,t as y,U as x,V as G,v as J,z as K,C as b}from"./index-CqyIjVgT.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as Y}from"./AlertCircleOutline-C8pr5-XU.js";const Z={class:"table-responsive"},ee={class:"text-lg font-bold m-0"},ae={__name:"DashboardAllUsers",setup(se){const{t:r}=q(),h=i([]),C=i(!1),d=i(!1),$=i(!1),m=E(),P=R(),L=i(null),p=i(null),o=i({name:"",email:"",password:"",password_confirmation:""}),B={name:[{required:!0,message:r("adminUsers.validation.name"),trigger:["input","blur"]}],email:[{required:!0,message:r("adminUsers.validation.email"),trigger:["input","blur"]},{type:"email",message:r("adminUsers.validation.invalidEmail"),trigger:["input","blur"]}],password:[{required:!1,min:6,message:r("adminUsers.validation.passwordLength"),trigger:["input","blur"]}],password_confirmation:[{validator:(e,a)=>a===o.value.password,message:r("adminUsers.validation.passwordMatch"),trigger:["input","blur"]}]},D=[{title:r("adminUsers.name"),key:"name"},{title:r("adminUsers.email"),key:"email"},{title:r("adminUsers.delete"),key:"actions",render(e){return g("div",{style:"display: flex; gap: 8px;"},[g(v,{size:"small",type:"info",secondary:!0,onClick:()=>M(e)},{default:()=>r("adminUsers.edit")}),g(v,{size:"small",type:"error",secondary:!0,onClick:()=>T(e.id)},{default:()=>r("adminUsers.delete")})])}}],k=async()=>{try{C.value=!0;const e=await U.get("users/admins");h.value=e.data}catch{m.error(r("adminUsers.errorLoad"))}finally{C.value=!1}},I=async()=>{var e;try{await((e=L.value)==null?void 0:e.validate()),$.value=!0;const a={name:o.value.name,email:o.value.email,...o.value.password?{password:o.value.password,password_confirmation:o.value.password_confirmation}:{}};p.value?(await U.put(`/users/${p.value}`,a),m.success(r("adminUsers.updateSuccess"))):(await U.post("/users/admins",a),m.success(r("adminUsers.addSuccess"))),d.value=!1,k()}catch{m.error(r("adminUsers.errorSave"))}finally{$.value=!1}},M=e=>{p.value=e.id,o.value={name:e.name,email:e.email,password:"",password_confirmation:""},d.value=!0},T=e=>{P.warning({title:r("adminUsers.deleteTitle"),content:r("adminUsers.deleteConfirm"),positiveText:r("adminUsers.delete"),negativeText:r("adminUsers.cancel"),positiveButtonProps:{type:"error"},icon:()=>g(Y,{style:"color: red; font-size: 22px;"}),onPositiveClick:async()=>{try{await U.delete(`/users/${e}`),m.success(r("adminUsers.deleteSuccess")),k()}catch{m.error("Failed to delete user")}}})},_=()=>{o.value={name:"",email:"",password:"",password_confirmation:""},p.value=null};A(d,e=>{e||_()});const u=i(""),f=i(1),w=i(5),j=S(()=>{const e=h.value.filter(s=>s.name.toLowerCase().includes(u.value.toLowerCase())||s.email.toLowerCase().includes(u.value.toLowerCase())),a=(f.value-1)*w.value;return e.slice(a,a+w.value)}),V=S(()=>h.value.filter(e=>e.name.toLowerCase().includes(u.value.toLowerCase())||e.email.toLowerCase().includes(u.value.toLowerCase())).length);return A(u,()=>{f.value=1}),H(k),(e,a)=>(X(),O(l(W),{title:e.$t("adminUsers.title")},{default:n(()=>[t(l(N),{justify:"space-between",align:"center",class:"mb-4"},{default:n(()=>[t(l(c),{value:u.value,"onUpdate:value":a[0]||(a[0]=s=>u.value=s),placeholder:e.$t("adminUsers.searchPlaceholder"),clearable:"",style:{"max-width":"300px"}},null,8,["value","placeholder"]),t(l(v),{type:"primary",onClick:a[1]||(a[1]=s=>d.value=!0)},{default:n(()=>[z(y(e.$t("adminUsers.addUser")),1)]),_:1})]),_:1}),F("div",Z,[t(l(x),{columns:D,data:j.value,loading:C.value,bordered:!0,striped:""},null,8,["data","loading"])]),t(l(N),{justify:"end",class:"mt-4"},{default:n(()=>[t(l(G),{page:f.value,"onUpdate:page":a[2]||(a[2]=s=>f.value=s),"page-size":w.value,"onUpdate:pageSize":a[3]||(a[3]=s=>w.value=s),"item-count":V.value,"show-size-picker":"","page-sizes":[5,10,20]},null,8,["page","page-size","item-count"])]),_:1}),t(l(J),{show:d.value,"onUpdate:show":a[9]||(a[9]=s=>d.value=s),preset:"card",style:{width:"500px"}},{header:n(()=>[F("h2",ee,y(p.value?e.$t("adminUsers.editUser"):e.$t("adminUsers.addNewAdmin")),1)]),default:n(()=>[t(l(K),{ref_key:"addUserFormRef",ref:L,model:o.value,rules:B,"label-width":"120px",size:"large"},{default:n(()=>[t(l(b),{label:e.$t("adminUsers.name"),path:"name"},{default:n(()=>[t(l(c),{value:o.value.name,"onUpdate:value":a[4]||(a[4]=s=>o.value.name=s),placeholder:e.$t("adminUsers.name")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(l(b),{label:e.$t("adminUsers.email"),path:"email"},{default:n(()=>[t(l(c),{value:o.value.email,"onUpdate:value":a[5]||(a[5]=s=>o.value.email=s),placeholder:e.$t("adminUsers.email")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(l(b),{label:e.$t("adminUsers.password"),path:"password"},{default:n(()=>[t(l(c),{value:o.value.password,"onUpdate:value":a[6]||(a[6]=s=>o.value.password=s),type:"password",placeholder:e.$t("adminUsers.password"),"show-password-on":"click"},null,8,["value","placeholder"])]),_:1},8,["label"]),t(l(b),{label:e.$t("adminUsers.confirmPassword"),path:"password_confirmation"},{default:n(()=>[t(l(c),{value:o.value.password_confirmation,"onUpdate:value":a[7]||(a[7]=s=>o.value.password_confirmation=s),type:"password",placeholder:e.$t("adminUsers.confirmPassword"),"show-password-on":"click"},null,8,["value","placeholder"])]),_:1},8,["label"]),t(l(N),{justify:"end",class:"mt-6"},{default:n(()=>[t(l(v),{onClick:a[8]||(a[8]=s=>d.value=!1)},{default:n(()=>[z(y(e.$t("adminUsers.cancel")),1)]),_:1}),t(l(v),{type:"primary",loading:$.value,onClick:I},{default:n(()=>[z(y(e.$t("adminUsers.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1},8,["title"]))}},ne=Q(ae,[["__scopeId","data-v-8d1f5765"]]);export{ne as default};
