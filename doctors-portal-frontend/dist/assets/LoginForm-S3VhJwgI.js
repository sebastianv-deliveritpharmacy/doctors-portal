import{t as E,r as n,v as P,e as h,c as B,i as t,w as l,u as r,q as C,g as F,o as M,x as R,y as p,z as c,A as v,C as _,k as U,a as q,D as z,m as g,B as w}from"./index-CIon11F2.js";import{i as K}from"./axios-D3XPDuSg.js";import{a as L}from"./apiRoutes-DVb9Ljmc.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={class:"login-container"},A={style:{display:"flex","justify-content":"space-between"}},D={__name:"LoginForm",setup(O){const b=E(),y=n(null),k=P(),S=n(!1),i=n(!1),s=n({email:"",password:""}),I={email:[{required:!0,message:"Please input your email",trigger:["input","blur"]},{type:"email",message:"Please enter a valid email address",trigger:["input","blur"]}],password:[{required:!0,message:"Please input your password",trigger:["input","blur"]},{min:6,message:"Password must be at least 6 characters",trigger:["input","blur"]}]},u=F(),x=async()=>{var m,e,o,f;try{const a=await K.post(L.login,{email:s.value.email,password:s.value.password});i.value?(localStorage.setItem("remember_me_email",s.value.email),localStorage.setItem("remember_me_password",s.value.password),localStorage.setItem("remember_me","true")):(localStorage.removeItem("remember_me_email"),localStorage.removeItem("remember_me_password"),localStorage.removeItem("remember_me")),a.data.two_factor_required?(localStorage.setItem("2fa_user_id",a.data.user_id),u.push("/verify-2fa")):(localStorage.setItem("access_token",a.data.token),b.setUser(a.data.user),u.push("/dashboard"))}catch(a){let d="Login failed, please check your credentials";if((e=(m=a==null?void 0:a.response)==null?void 0:m.data)!=null&&e.errors){const N=Object.keys(a.response.data.errors)[0];d=a.response.data.errors[N][0]}else(f=(o=a==null?void 0:a.response)==null?void 0:o.data)!=null&&f.message&&(d=a.response.data.message);k.error(d)}};return h(()=>{const m=localStorage.getItem("remember_me_email"),e=localStorage.getItem("remember_me_password");m&&e&&(s.value.email=m,s.value.password=e,i.value=!0)}),(m,e)=>(M(),B("div",j,[t(r(C),{title:"Login",hoverable:"",class:"login-card"},{default:l(()=>[t(r(R),{ref_key:"formRef",ref:y,model:s.value,rules:I,size:"large",onSubmit:p(x,["prevent"])},{default:l(()=>[t(r(c),{path:"email",label:"Email"},{default:l(()=>[t(r(v),{value:s.value.email,"onUpdate:value":e[0]||(e[0]=o=>s.value.email=o),placeholder:"Enter your email",onKeydown:e[1]||(e[1]=_(p(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(r(c),{path:"password",label:"Password"},{default:l(()=>[t(r(v),{value:s.value.password,"onUpdate:value":e[2]||(e[2]=o=>s.value.password=o),type:"password",placeholder:"Enter your password","show-password-on":"click",onKeydown:e[3]||(e[3]=_(p(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1}),t(r(U),{vertical:"",size:24},{default:l(()=>[q("div",A,[t(r(z),{checked:i.value,"onUpdate:checked":e[4]||(e[4]=o=>i.value=o)},{default:l(()=>e[6]||(e[6]=[g("Remember me")])),_:1,__:[6]},8,["checked"]),t(r(w),{text:"",onClick:e[5]||(e[5]=o=>r(u).push("/forgot-password"))},{default:l(()=>e[7]||(e[7]=[g(" Forgot password? ")])),_:1,__:[7]})]),t(r(w),{type:"primary",size:"large",block:!0,loading:S.value,"attr-type":"submit",style:{"background-color":"#2080f0"}},{default:l(()=>e[8]||(e[8]=[g(" Sign in ")])),_:1,__:[8]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})]))}},J=V(D,[["__scopeId","data-v-b7293a58"]]);export{J as default};
