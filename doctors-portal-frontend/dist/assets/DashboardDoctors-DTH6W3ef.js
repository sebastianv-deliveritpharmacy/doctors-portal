import{i as y}from"./axios-D3XPDuSg.js";import{u as E,r as i,y as H,W as O,H as z,I as f,B as v,h as W,X as D,e as X,f as G,w as d,g as o,s as J,o as K,j as l,a as I,l as N,D as m,n as _,t as b,U as Q,V as Y,v as Z,z as x,C as w}from"./index-4FCvwASn.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as ae}from"./AlertCircleOutline-CrJrly_J.js";const se={class:"table-responsive"},te={class:"text-lg font-bold m-0"},oe={__name:"DashboardDoctors",setup(le){const{t:s}=E(),U=i([]),$=i(!1),n=i(!1),C=i(!1),p=H(),P=O(),L=i(null),u=i(null),S=W(),r=i({name:"",email:"",sheet_identifier:"",password:"",password_confirmation:""}),B=z(()=>({name:[{required:!0,message:s("doctors.validation.name"),trigger:["input","blur"]}],email:[{required:!0,message:s("doctors.validation.email"),trigger:["input","blur"]},{type:"email",message:s("doctors.validation.invalidEmail"),trigger:["input","blur"]}],sheet_identifier:[{required:!0,message:s("doctors.validation.sheet"),trigger:["input","blur"]}],password:u.value?[]:[{required:!0,min:6,message:s("doctors.validation.passwordLength"),trigger:["input","blur"]}],password_confirmation:u.value?[]:[{validator:(e,a)=>a===r.value.password,message:s("doctors.validation.passwordMatch"),trigger:["input","blur"]}]})),F=[{title:s("doctors.name"),key:"name"},{title:s("doctors.email"),key:"email"},{title:s("doctors.delete"),key:"actions",render(e){return f("div",{style:"display: flex; gap: 8px;"},[f(v,{size:"small",type:"info",secondary:!0,onClick:()=>T(e)},{default:()=>s("doctors.edit")}),f(v,{size:"small",type:"primary",secondary:!0,onClick:()=>j(e.id)},{default:()=>s("doctors.prescriptions")}),f(v,{size:"small",type:"error",secondary:!0,onClick:()=>A(e.id)},{default:()=>s("doctors.delete")})])}}],k=async()=>{try{$.value=!0;const e=await y.get("/users");U.value=e.data}catch{p.error(s("doctors.errorLoad"))}finally{$.value=!1}},M=async()=>{var e;try{await((e=L.value)==null?void 0:e.validate()),C.value=!0;const a={name:r.value.name,email:r.value.email,sheet_identifier:r.value.sheet_identifier,...r.value.password?{password:r.value.password,password_confirmation:r.value.password_confirmation}:{}};u.value?(await y.put(`/users/${u.value}`,a),p.success(s("doctors.updateSuccess"))):(await y.post("/users",{...a,is_admin:!1}),p.success(s("doctors.addSuccess"))),n.value=!1,k()}catch{p.error(s("doctors.errorSave"))}finally{C.value=!1}},T=e=>{u.value=e.id,r.value={name:e.name,email:e.email,sheet_identifier:e.sheet_identifier,password:"",password_confirmation:""},n.value=!0},A=e=>{P.warning({title:s("doctors.deleteTitle"),content:s("doctors.deleteConfirm"),positiveText:s("doctors.delete"),negativeText:s("doctors.cancel"),positiveButtonProps:{type:"error"},icon:()=>f(ae,{style:"color: red; font-size: 22px;"}),onPositiveClick:async()=>{try{await y.delete(`/users/${e}`),p.success(s("doctors.deleteSuccess")),k()}catch{p.error(s("doctors.errorDelete"))}}})},j=e=>{S.push(`/dashboard/doctors/${e}/prescriptions`)},q=()=>{r.value={name:"",email:"",sheet_identifier:"",password:"",password_confirmation:""},u.value=null};D(n,e=>{e||q()});const c=i(""),g=i(1),h=i(5),V=z(()=>{const e=U.value.filter(t=>t.name.toLowerCase().includes(c.value.toLowerCase())||t.email.toLowerCase().includes(c.value.toLowerCase())),a=(g.value-1)*h.value;return e.slice(a,a+h.value)}),R=z(()=>U.value.filter(e=>e.name.toLowerCase().includes(c.value.toLowerCase())||e.email.toLowerCase().includes(c.value.toLowerCase())).length);return D(c,()=>{g.value=1}),X(k),(e,a)=>(K(),G(o(J),{title:e.$t("doctors.title")},{default:d(()=>[l(o(N),{justify:"space-between",align:"center",class:"mb-4"},{default:d(()=>[l(o(m),{value:c.value,"onUpdate:value":a[0]||(a[0]=t=>c.value=t),placeholder:e.$t("doctors.searchPlaceholder"),clearable:"",style:{"max-width":"300px"}},null,8,["value","placeholder"]),l(o(v),{type:"primary",onClick:a[1]||(a[1]=t=>n.value=!0)},{default:d(()=>[_(b(e.$t("doctors.add")),1)]),_:1})]),_:1}),I("div",se,[l(o(Q),{columns:F,data:V.value,loading:$.value,bordered:!0,striped:""},null,8,["data","loading"])]),l(o(N),{justify:"end",class:"mt-4"},{default:d(()=>[l(o(Y),{page:g.value,"onUpdate:page":a[2]||(a[2]=t=>g.value=t),"page-size":h.value,"onUpdate:pageSize":a[3]||(a[3]=t=>h.value=t),"item-count":R.value,"show-size-picker":"","page-sizes":[5,10,20]},null,8,["page","page-size","item-count"])]),_:1}),l(o(Z),{show:n.value,"onUpdate:show":a[10]||(a[10]=t=>n.value=t),preset:"card",style:{width:"500px"}},{header:d(()=>[I("h2",te,b(u.value?e.$t("doctors.edit"):e.$t("doctors.addNew")),1)]),default:d(()=>[l(o(x),{ref_key:"addUserFormRef",ref:L,model:r.value,rules:B.value,"label-width":"120px",size:"large"},{default:d(()=>[l(o(w),{label:e.$t("doctors.name"),path:"name"},{default:d(()=>[l(o(m),{value:r.value.name,"onUpdate:value":a[4]||(a[4]=t=>r.value.name=t),placeholder:e.$t("doctors.name")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(o(w),{label:e.$t("doctors.email"),path:"email"},{default:d(()=>[l(o(m),{value:r.value.email,"onUpdate:value":a[5]||(a[5]=t=>r.value.email=t),placeholder:e.$t("doctors.email")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(o(w),{label:e.$t("doctors.sheetId"),path:"sheet"},{default:d(()=>[l(o(m),{value:r.value.sheet_identifier,"onUpdate:value":a[6]||(a[6]=t=>r.value.sheet_identifier=t),placeholder:e.$t("doctors.sheetId")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(o(w),{label:e.$t("doctors.password"),path:"password"},{default:d(()=>[l(o(m),{value:r.value.password,"onUpdate:value":a[7]||(a[7]=t=>r.value.password=t),type:"password",placeholder:e.$t("doctors.password"),"show-password-on":"click"},null,8,["value","placeholder"])]),_:1},8,["label"]),l(o(w),{label:e.$t("doctors.confirmPassword"),path:"password_confirmation"},{default:d(()=>[l(o(m),{value:r.value.password_confirmation,"onUpdate:value":a[8]||(a[8]=t=>r.value.password_confirmation=t),type:"password",placeholder:e.$t("doctors.confirmPassword"),"show-password-on":"click"},null,8,["value","placeholder"])]),_:1},8,["label"]),l(o(N),{justify:"end",class:"mt-6"},{default:d(()=>[l(o(v),{onClick:a[9]||(a[9]=t=>n.value=!1)},{default:d(()=>[_(b(e.$t("doctors.cancel")),1)]),_:1}),l(o(v),{type:"primary",loading:C.value,onClick:M},{default:d(()=>[_(b(e.$t("doctors.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["show"])]),_:1},8,["title"]))}},ue=ee(oe,[["__scopeId","data-v-1a04b5e7"]]);export{ue as default};
