import{i as f}from"./axios-D3XPDuSg.js";import{v as h,r as u,e as y,f as b,w as t,u as r,q as N,g as P,o as k,i as l,x,z as i,A as n,B as F,m as U}from"./index-CTfbxDGa.js";const I={__name:"DashboardProfile",setup(q){const d=h(),v=P(),m=u(null),p=u(!1),e=u({name:"",email:"",password:"",password_confirmation:""}),c={name:[{required:!0,message:"Name is required",trigger:["input","blur"]}],email:[{required:!0,message:"Email is required",trigger:["input","blur"]},{type:"email",message:"Invalid email format",trigger:["input","blur"]}],password:[{min:6,message:"Password must be at least 6 characters",trigger:["input","blur"]}],password_confirmation:[{validator:(o,a)=>a===e.value.password,message:"Passwords do not match",trigger:["input","blur"]}]},w=u(null),g=async()=>{try{const a=(await f.get("/user")).data;w.value=a.id,e.value.name=a.name,e.value.email=a.email}catch(o){console.error("Failed to fetch user",o),d.error("Failed to fetch user data"),v.push("/login")}},_=async()=>{var o,a;try{p.value=!0,await((o=m.value)==null?void 0:o.validate());const s={name:e.value.name,email:e.value.email};e.value.password&&(s.password=e.value.password,s.password_confirmation=e.value.password_confirmation),await f.put("/user",s),d.success("Profile updated successfully!"),e.value.password="",e.value.password_confirmation=""}catch(s){console.error("Failed to update profile",((a=s==null?void 0:s.response)==null?void 0:a.data)||s.message),d.error("Failed to update profile. Please check the form.")}finally{p.value=!1}};return y(()=>{g()}),(o,a)=>(k(),b(r(N),{title:"Your Profile"},{default:t(()=>[l(r(x),{ref_key:"formRef",ref:m,model:e.value,rules:c,"label-width":"120px",size:"large"},{default:t(()=>[l(r(i),{label:"Name",path:"name"},{default:t(()=>[l(r(n),{value:e.value.name,"onUpdate:value":a[0]||(a[0]=s=>e.value.name=s),placeholder:"Your name"},null,8,["value"])]),_:1}),l(r(i),{label:"Email",path:"email"},{default:t(()=>[l(r(n),{value:e.value.email,"onUpdate:value":a[1]||(a[1]=s=>e.value.email=s),placeholder:"Your email"},null,8,["value"])]),_:1}),l(r(i),{label:"New password",path:"password"},{default:t(()=>[l(r(n),{value:e.value.password,"onUpdate:value":a[2]||(a[2]=s=>e.value.password=s),type:"password",placeholder:"New password","show-password-on":"click"},null,8,["value"])]),_:1}),l(r(i),{label:"Confirm password",path:"password_confirmation"},{default:t(()=>[l(r(n),{value:e.value.password_confirmation,"onUpdate:value":a[3]||(a[3]=s=>e.value.password_confirmation=s),type:"password",placeholder:"Confirm password","show-password-on":"click"},null,8,["value"])]),_:1}),l(r(F),{type:"primary",loading:p.value,onClick:_},{default:t(()=>a[4]||(a[4]=[U(" Update Profile ")])),_:1,__:[4]},8,["loading"])]),_:1},8,["model"])]),_:1}))}};export{I as default};
