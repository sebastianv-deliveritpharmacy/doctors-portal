import{i as w}from"./axios-D3XPDuSg.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as i,v as I,V,W as A,F as h,e as $,f as j,w as o,u as l,q as R,o as G,i as t,a as z,k,A as m,B as v,m as x,S as K,T as O,s as W,x as H,z as g,K as J,G as y}from"./index-CDUznlbP.js";import{A as Q}from"./AlertCircleOutline-C7I8S8HD.js";const X={class:"table-responsive"},Y={class:"text-lg font-bold m-0"},Z={__name:"DashboardAllUsers",setup(ee){const U=i([]),b=i(!1),n=i(!1),C=i(!1),d=I(),F=V(),N=i(null),p=i(null),r=i({name:"",email:"",password:"",password_confirmation:""}),P={name:[{required:!0,message:"Name is required",trigger:["input","blur"]}],email:[{required:!0,message:"Email is required",trigger:["input","blur"]},{type:"email",message:"Invalid email",trigger:["input","blur"]}],password:[{required:!1,min:6,message:"Password must be at least 6 characters",trigger:["input","blur"]}],password_confirmation:[{validator:(a,e)=>e===r.value.password,message:"Passwords do not match",trigger:["input","blur"]}]},D=[{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Actions",key:"actions",render(a){return y("div",{style:"display: flex; gap: 8px;"},[y(v,{size:"small",type:"info",secondary:!0,onClick:()=>S(a)},{default:()=>"Edit"}),y(v,{size:"small",type:"error",secondary:!0,onClick:()=>q(a.id)},{default:()=>"Delete"})])}}],_=async()=>{try{b.value=!0;const a=await w.get("users/admins");U.value=a.data}catch{d.error("Failed to load users")}finally{b.value=!1}},L=async()=>{var a;try{await((a=N.value)==null?void 0:a.validate()),C.value=!0;const e={name:r.value.name,email:r.value.email,...r.value.password?{password:r.value.password,password_confirmation:r.value.password_confirmation}:{}};p.value?(await w.put(`/users/${p.value}`,e),d.success("User updated successfully!")):(await w.post("/users/admins",e),d.success("User added successfully!")),n.value=!1,_()}catch{d.error("Failed to save user")}finally{C.value=!1}},S=a=>{p.value=a.id,r.value={name:a.name,email:a.email,password:"",password_confirmation:""},n.value=!0},q=a=>{F.warning({title:"Delete User",content:"Are you sure you want to delete this user?",positiveText:"Delete",negativeText:"Cancel",positiveButtonProps:{type:"error"},icon:()=>y(Q,{style:"color: red; font-size: 22px;"}),onPositiveClick:async()=>{try{await w.delete(`/users/${a}`),d.success("User deleted successfully!"),_()}catch{d.error("Failed to delete user")}}})},B=()=>{r.value={name:"",email:"",password:"",password_confirmation:""},p.value=null};A(n,a=>{a||B()});const u=i(""),c=i(1),f=i(5),E=h(()=>{const a=U.value.filter(s=>s.name.toLowerCase().includes(u.value.toLowerCase())||s.email.toLowerCase().includes(u.value.toLowerCase())),e=(c.value-1)*f.value;return a.slice(e,e+f.value)}),M=h(()=>U.value.filter(a=>a.name.toLowerCase().includes(u.value.toLowerCase())||a.email.toLowerCase().includes(u.value.toLowerCase())).length);return A(u,()=>{c.value=1}),$(_),(a,e)=>(G(),j(l(R),{title:"Manage Admins"},{default:o(()=>[t(l(k),{justify:"space-between",align:"center",class:"mb-4"},{default:o(()=>[t(l(m),{value:u.value,"onUpdate:value":e[0]||(e[0]=s=>u.value=s),placeholder:"Search users...",clearable:"",style:{"max-width":"300px"}},null,8,["value"]),t(l(v),{type:"primary",onClick:e[1]||(e[1]=s=>n.value=!0)},{default:o(()=>e[10]||(e[10]=[x(" Add User ")])),_:1,__:[10]})]),_:1}),z("div",X,[t(l(K),{columns:D,data:E.value,loading:b.value,bordered:!0,striped:""},null,8,["data","loading"])]),t(l(k),{justify:"end",class:"mt-4"},{default:o(()=>[t(l(O),{page:c.value,"onUpdate:page":e[2]||(e[2]=s=>c.value=s),"page-size":f.value,"onUpdate:pageSize":e[3]||(e[3]=s=>f.value=s),"item-count":M.value,"show-size-picker":"","page-sizes":[5,10,20]},null,8,["page","page-size","item-count"])]),_:1}),t(l(W),{show:n.value,"onUpdate:show":e[9]||(e[9]=s=>n.value=s),preset:"card",style:{width:"500px"}},{header:o(()=>[z("h2",Y,J(p.value?"Edit User":"Add New Admin"),1)]),default:o(()=>[t(l(H),{ref_key:"addUserFormRef",ref:N,model:r.value,rules:P,"label-width":"120px",size:"large"},{default:o(()=>[t(l(g),{label:"Name",path:"name"},{default:o(()=>[t(l(m),{value:r.value.name,"onUpdate:value":e[4]||(e[4]=s=>r.value.name=s),placeholder:"User name"},null,8,["value"])]),_:1}),t(l(g),{label:"Email",path:"email"},{default:o(()=>[t(l(m),{value:r.value.email,"onUpdate:value":e[5]||(e[5]=s=>r.value.email=s),placeholder:"User email"},null,8,["value"])]),_:1}),t(l(g),{label:"Password",path:"password"},{default:o(()=>[t(l(m),{value:r.value.password,"onUpdate:value":e[6]||(e[6]=s=>r.value.password=s),type:"password",placeholder:"Password","show-password-on":"click"},null,8,["value"])]),_:1}),t(l(g),{label:"Confirm Password",path:"password_confirmation"},{default:o(()=>[t(l(m),{value:r.value.password_confirmation,"onUpdate:value":e[7]||(e[7]=s=>r.value.password_confirmation=s),type:"password",placeholder:"Confirm Password","show-password-on":"click"},null,8,["value"])]),_:1}),t(l(k),{justify:"end",class:"mt-6"},{default:o(()=>[t(l(v),{onClick:e[8]||(e[8]=s=>n.value=!1)},{default:o(()=>e[11]||(e[11]=[x("Cancel")])),_:1,__:[11]}),t(l(v),{type:"primary",loading:C.value,onClick:L},{default:o(()=>e[12]||(e[12]=[x(" Save ")])),_:1,__:[12]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1}))}},re=T(Z,[["__scopeId","data-v-bec784ef"]]);export{re as default};
