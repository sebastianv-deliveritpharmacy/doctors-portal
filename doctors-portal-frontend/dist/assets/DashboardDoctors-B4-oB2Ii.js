import{i as g}from"./axios-D3XPDuSg.js";import{r as i,v as $,W as R,R as N,F as D,e as j,f as V,w as r,u as t,q as G,g as K,o as O,i as l,a as z,k,A as c,B as p,m as h,T as W,U as H,s as J,x as Q,z as y,K as X,G as v}from"./index-CIon11F2.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{A as Z}from"./AlertCircleOutline-Bjc5m7Jc.js";const ee={class:"table-responsive"},ae={class:"text-lg font-bold m-0"},se={__name:"DashboardDoctors",setup(te){const U=i([]),b=i(!1),n=i(!1),C=i(!1),d=$(),P=R(),x=i(null),m=i(null),A=K(),o=i({name:"",email:"",password:"",password_confirmation:""}),F={name:[{required:!0,message:"Name is required",trigger:["input","blur"]}],email:[{required:!0,message:"Email is required",trigger:["input","blur"]},{type:"email",message:"Invalid email",trigger:["input","blur"]}],password:[{required:!0,min:6,message:"Password must be at least 6 characters",trigger:["input","blur"]}],password_confirmation:[{validator:(a,e)=>e===o.value.password,message:"Passwords do not match",trigger:["input","blur"]}]},L=[{title:"Name",key:"name"},{title:"Email",key:"email"},{title:"Actions",key:"actions",render(a){return v("div",{style:"display: flex; gap: 8px;"},[v(p,{size:"small",type:"info",secondary:!0,onClick:()=>q(a)},{default:()=>"Edit"}),v(p,{size:"small",type:"primary",secondary:!0,onClick:()=>E(a.id)},{default:()=>"Prescriptions"}),v(p,{size:"small",type:"error",secondary:!0,onClick:()=>B(a.id)},{default:()=>"Delete"})])}}],_=async()=>{try{b.value=!0;const a=await g.get("/users");U.value=a.data}catch{d.error("Failed to load users")}finally{b.value=!1}},T=async()=>{var a;try{await((a=x.value)==null?void 0:a.validate()),C.value=!0;const e={name:o.value.name,email:o.value.email,...o.value.password?{password:o.value.password,password_confirmation:o.value.password_confirmation}:{}};m.value?(await g.put(`/users/${m.value}`,e),d.success("User updated successfully!")):(await g.post("/users",{...e,is_admin:!1}),d.success("User added successfully!")),n.value=!1,_()}catch{d.error("Failed to save user")}finally{C.value=!1}},q=a=>{m.value=a.id,o.value={name:a.name,email:a.email,password:"",password_confirmation:""},n.value=!0},B=a=>{P.warning({title:"Delete User",content:"Are you sure you want to delete this user? This action cannot be undone.",positiveText:"Delete",negativeText:"Cancel",positiveButtonProps:{type:"error"},icon:()=>v(Z,{style:"color: red; font-size: 22px;"}),onPositiveClick:async()=>{try{await g.delete(`/users/${a}`),d.success("User deleted successfully!"),_()}catch{d.error("Failed to delete user")}}})},E=a=>{A.push(`/dashboard/doctors/${a}/prescriptions`)},M=()=>{o.value={name:"",email:"",password:"",password_confirmation:""},m.value=null};N(n,a=>{a||M()});const u=i(""),f=i(1),w=i(5),S=D(()=>{const a=U.value.filter(s=>s.name.toLowerCase().includes(u.value.toLowerCase())||s.email.toLowerCase().includes(u.value.toLowerCase())),e=(f.value-1)*w.value;return a.slice(e,e+w.value)}),I=D(()=>U.value.filter(a=>a.name.toLowerCase().includes(u.value.toLowerCase())||a.email.toLowerCase().includes(u.value.toLowerCase())).length);return N(u,()=>{f.value=1}),j(_),(a,e)=>(O(),V(t(G),{title:"Manage Doctors"},{default:r(()=>[l(t(k),{justify:"space-between",align:"center",class:"mb-4"},{default:r(()=>[l(t(c),{value:u.value,"onUpdate:value":e[0]||(e[0]=s=>u.value=s),placeholder:"Search doctors...",clearable:"",style:{"max-width":"300px"}},null,8,["value"]),l(t(p),{type:"primary",onClick:e[1]||(e[1]=s=>n.value=!0)},{default:r(()=>e[10]||(e[10]=[h(" Add Doctor ")])),_:1,__:[10]})]),_:1}),z("div",ee,[l(t(W),{columns:L,data:S.value,loading:b.value,bordered:!0,striped:""},null,8,["data","loading"])]),l(t(k),{justify:"end",class:"mt-4"},{default:r(()=>[l(t(H),{page:f.value,"onUpdate:page":e[2]||(e[2]=s=>f.value=s),"page-size":w.value,"onUpdate:pageSize":e[3]||(e[3]=s=>w.value=s),"item-count":I.value,"show-size-picker":"","page-sizes":[5,10,20]},null,8,["page","page-size","item-count"])]),_:1}),l(t(J),{show:n.value,"onUpdate:show":e[9]||(e[9]=s=>n.value=s),preset:"card",style:{width:"500px"}},{header:r(()=>[z("h2",ae,X(m.value?"Edit Doctor":"Add New Doctor"),1)]),default:r(()=>[l(t(Q),{ref_key:"addUserFormRef",ref:x,model:o.value,rules:F,"label-width":"120px",size:"large"},{default:r(()=>[l(t(y),{label:"Name",path:"name"},{default:r(()=>[l(t(c),{value:o.value.name,"onUpdate:value":e[4]||(e[4]=s=>o.value.name=s),placeholder:"User name"},null,8,["value"])]),_:1}),l(t(y),{label:"Email",path:"email"},{default:r(()=>[l(t(c),{value:o.value.email,"onUpdate:value":e[5]||(e[5]=s=>o.value.email=s),placeholder:"User email"},null,8,["value"])]),_:1}),l(t(y),{label:"Password",path:"password"},{default:r(()=>[l(t(c),{value:o.value.password,"onUpdate:value":e[6]||(e[6]=s=>o.value.password=s),type:"password",placeholder:"Password","show-password-on":"click"},null,8,["value"])]),_:1}),l(t(y),{label:"Confirm Password",path:"password_confirmation"},{default:r(()=>[l(t(c),{value:o.value.password_confirmation,"onUpdate:value":e[7]||(e[7]=s=>o.value.password_confirmation=s),type:"password",placeholder:"Confirm Password","show-password-on":"click"},null,8,["value"])]),_:1}),l(t(k),{justify:"end",class:"mt-6"},{default:r(()=>[l(t(p),{onClick:e[8]||(e[8]=s=>n.value=!1)},{default:r(()=>e[11]||(e[11]=[h("Cancel")])),_:1,__:[11]}),l(t(p),{type:"primary",loading:C.value,onClick:T},{default:r(()=>e[12]||(e[12]=[h(" Save ")])),_:1,__:[12]},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1}))}},ne=Y(se,[["__scopeId","data-v-7cd93a67"]]);export{ne as default};
