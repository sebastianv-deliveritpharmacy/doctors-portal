import{u as P,x as U,r as u,y as z,e as B,c as F,j as r,w as i,g as o,s as V,h as E,o as K,z as R,A as c,C as b,D as _,E as y,l as k,a as j,F as q,n as g,t as p,B as v}from"./index-C_dhaJxW.js";import{i as D}from"./axios-D3XPDuSg.js";import{a as L}from"./apiRoutes-CgTPNgLq.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"login-container"},T={class:"login-links"},x={__name:"LoginForm",setup(G){const{t:n}=P(),I=U(),S=u(null),h=z(),M=u(!1),m=u(!1),l=u({email:"",password:""}),$={email:[{required:!0,message:n("login.loginMsg.emailMsg"),trigger:["input","blur"]},{type:"email",message:n("login.loginMsg.emailMsgValid"),trigger:["input","blur"]}],password:[{required:!0,message:n("login.loginMsg.emailPwd"),trigger:["input","blur"]},{min:6,message:n("login.loginMsg.emailPwdCh"),trigger:["input","blur"]}]},d=E(),N=async()=>{var a,e,t,w;try{const s=await D.post(L.login,{email:l.value.email,password:l.value.password});m.value?(localStorage.setItem("remember_me_email",l.value.email),localStorage.setItem("remember_me_password",l.value.password),localStorage.setItem("remember_me","true")):(localStorage.removeItem("remember_me_email"),localStorage.removeItem("remember_me_password"),localStorage.removeItem("remember_me")),s.data.two_factor_required?(localStorage.setItem("2fa_user_id",s.data.user_id),d.push("/verify-2fa")):(localStorage.setItem("access_token",s.data.token),I.setUser(s.data.user),d.push("/dashboard"))}catch(s){let f=n("login.errorMessage");if((e=(a=s==null?void 0:s.response)==null?void 0:a.data)!=null&&e.errors){const C=Object.keys(s.response.data.errors)[0];f=s.response.data.errors[C][0]}else(w=(t=s==null?void 0:s.response)==null?void 0:t.data)!=null&&w.message&&(f=s.response.data.message);h.error(f)}};return B(()=>{const a=localStorage.getItem("remember_me_email"),e=localStorage.getItem("remember_me_password");a&&e&&(l.value.email=a,l.value.password=e,m.value=!0)}),(a,e)=>(K(),F("div",O,[r(o(V),{title:a.$t("login.title"),hoverable:"",class:"login-card"},{default:i(()=>[r(o(R),{ref_key:"formRef",ref:S,model:l.value,rules:$,size:"large",onSubmit:c(N,["prevent"])},{default:i(()=>[r(o(b),{path:"email",label:a.$t("login.email")},{default:i(()=>[r(o(_),{value:l.value.email,"onUpdate:value":e[0]||(e[0]=t=>l.value.email=t),placeholder:a.$t("login.emailPlaceholder"),onKeydown:e[1]||(e[1]=y(c(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["label"]),r(o(b),{path:"password",label:a.$t("login.password")},{default:i(()=>[r(o(_),{value:l.value.password,"onUpdate:value":e[2]||(e[2]=t=>l.value.password=t),type:"password",placeholder:a.$t("login.passwordPlaceholder"),"show-password-on":"click",onKeydown:e[3]||(e[3]=y(c(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["label"]),r(o(k),{vertical:"",size:24},{default:i(()=>[j("div",T,[r(o(q),{checked:m.value,"onUpdate:checked":e[4]||(e[4]=t=>m.value=t)},{default:i(()=>[g(p(a.$t("login.rememberMe")),1)]),_:1},8,["checked"]),r(o(k),{size:"small",justify:"end"},{default:i(()=>[r(o(v),{text:"",onClick:e[5]||(e[5]=t=>o(d).push("/forgot-password"))},{default:i(()=>[g(p(a.$t("login.forgotPassword")),1)]),_:1}),r(o(v),{text:"",onClick:e[6]||(e[6]=t=>o(d).push("/sign-up"))},{default:i(()=>[g(p(a.$t("login.signUp")),1)]),_:1})]),_:1})]),r(o(v),{type:"primary",size:"large",block:!0,loading:M.value,"attr-type":"submit",style:{"background-color":"#2080f0"}},{default:i(()=>[g(p(a.$t("login.signIn")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]))}},X=A(x,[["__scopeId","data-v-d2d4fb0c"]]);export{X as default};
