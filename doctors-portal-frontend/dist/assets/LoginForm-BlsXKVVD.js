import{u as C,x as P,r as d,y as B,e as F,c as U,j as t,w as i,g as r,s as V,h as z,o as E,z as K,A as p,C as w,D as b,E as _,l as R,a as j,F as q,n as c,t as f,B as y}from"./index-CaOXgG-J.js";import{i as D}from"./axios-D3XPDuSg.js";import{a as L}from"./apiRoutes-DVb9Ljmc.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"login-container"},O={style:{display:"flex","justify-content":"space-between"}},T={__name:"LoginForm",setup(G){const{t:n}=C(),h=P(),I=d(null),S=B(),k=d(!1),m=d(!1),o=d({email:"",password:""}),M={email:[{required:!0,message:n("login.loginMsg.emailMsg"),trigger:["input","blur"]},{type:"email",message:n("login.loginMsg.emailMsgValid"),trigger:["input","blur"]}],password:[{required:!0,message:n("login.loginMsg.emailPwd"),trigger:["input","blur"]},{min:6,message:n("login.loginMsg.emailPwdCh"),trigger:["input","blur"]}]},u=z(),N=async()=>{var a,e,l,v;try{const s=await D.post(L.login,{email:o.value.email,password:o.value.password});m.value?(localStorage.setItem("remember_me_email",o.value.email),localStorage.setItem("remember_me_password",o.value.password),localStorage.setItem("remember_me","true")):(localStorage.removeItem("remember_me_email"),localStorage.removeItem("remember_me_password"),localStorage.removeItem("remember_me")),s.data.two_factor_required?(localStorage.setItem("2fa_user_id",s.data.user_id),u.push("/verify-2fa")):(localStorage.setItem("access_token",s.data.token),h.setUser(s.data.user),u.push("/dashboard"))}catch(s){let g=n("login.errorMessage");if((e=(a=s==null?void 0:s.response)==null?void 0:a.data)!=null&&e.errors){const $=Object.keys(s.response.data.errors)[0];g=s.response.data.errors[$][0]}else(v=(l=s==null?void 0:s.response)==null?void 0:l.data)!=null&&v.message&&(g=s.response.data.message);S.error(g)}};return F(()=>{const a=localStorage.getItem("remember_me_email"),e=localStorage.getItem("remember_me_password");a&&e&&(o.value.email=a,o.value.password=e,m.value=!0)}),(a,e)=>(E(),U("div",A,[t(r(V),{title:a.$t("login.title"),hoverable:"",class:"login-card"},{default:i(()=>[t(r(K),{ref_key:"formRef",ref:I,model:o.value,rules:M,size:"large",onSubmit:p(N,["prevent"])},{default:i(()=>[t(r(w),{path:"email",label:a.$t("login.email")},{default:i(()=>[t(r(b),{value:o.value.email,"onUpdate:value":e[0]||(e[0]=l=>o.value.email=l),placeholder:a.$t("login.emailPlaceholder"),onKeydown:e[1]||(e[1]=_(p(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["label"]),t(r(w),{path:"password",label:a.$t("login.password")},{default:i(()=>[t(r(b),{value:o.value.password,"onUpdate:value":e[2]||(e[2]=l=>o.value.password=l),type:"password",placeholder:a.$t("login.passwordPlaceholder"),"show-password-on":"click",onKeydown:e[3]||(e[3]=_(p(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["label"]),t(r(R),{vertical:"",size:24},{default:i(()=>[j("div",O,[t(r(q),{checked:m.value,"onUpdate:checked":e[4]||(e[4]=l=>m.value=l)},{default:i(()=>[c(f(a.$t("login.rememberMe")),1)]),_:1},8,["checked"]),t(r(y),{text:"",onClick:e[5]||(e[5]=l=>r(u).push("/forgot-password"))},{default:i(()=>[c(f(a.$t("login.forgotPassword")),1)]),_:1})]),t(r(y),{type:"primary",size:"large",block:!0,loading:k.value,"attr-type":"submit",style:{"background-color":"#2080f0"}},{default:i(()=>[c(f(a.$t("login.signIn")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])]))}},X=x(T,[["__scopeId","data-v-65d18883"]]);export{X as default};
