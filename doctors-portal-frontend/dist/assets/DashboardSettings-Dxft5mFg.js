import{i as p}from"./axios-D3XPDuSg.js";import{x as A,H as E,u as M,y as P,r as f,e as R,f as b,w as s,i as o,o as h,j as a,K as C,a as I,t as g,g as D,n as m}from"./index-CqyIjVgT.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"switcher-title"},H={class:"section-title"},L={__name:"DashboardSettings",setup(F){const q=A(),c=E(()=>q.isSuperAdmin()),{t:n,locale:v}=M(),i=P(),w=f(null),l=f({client_id:"",secret:""}),r=f(!1),_=f(!1),N={client_id:[{required:!0,message:n("settings.requiredClientId"),trigger:["input","blur"]}],secret:[{required:!0,message:n("settings.requiredSecret"),trigger:["input","blur"]}]};function S(e){v.value=e,localStorage.setItem("language",e)}const U=async()=>{if(c.value)try{const e=await p.get("/caretend-credential");e.data?(l.value={client_id:e.data.client_id,secret:e.data.secret},r.value=!0):r.value=!1}catch{r.value=!1}},V=async()=>{var e;if(!c.value){i.error(n("settings.insufficientPermissions")||"Insufficient permissions.");return}try{await((e=w.value)==null?void 0:e.validate()),_.value=!0,r.value?(await p.put("/caretend-credential",l.value),i.success(n("settings.successUpdate"))):(await p.post("/caretend-credential",l.value),i.success(n("settings.successSave")),r.value=!0)}catch{i.error(n("settings.errorSave"))}finally{_.value=!1}},B=async()=>{if(!c.value){i.error(n("settings.insufficientPermissions")||"Insufficient permissions.");return}try{await p.delete("/caretend-credential"),l.value={client_id:"",secret:""},r.value=!1,i.success(n("settings.successDelete"))}catch{i.error(n("settings.errorDelete"))}};return R(U),(e,t)=>{const d=o("n-button"),y=o("n-space"),$=o("n-input"),k=o("n-form-item"),K=o("n-form"),j=o("n-card");return h(),b(j,{title:e.$t("settings.title")},{default:s(()=>[a(y,{vertical:"",align:"start",class:"mb-4"},{default:s(()=>[I("span",z,g(e.$t("settings.languageTitle")),1),a(y,null,{default:s(()=>[a(d,{onClick:t[0]||(t[0]=u=>S("en")),type:D(v)==="en"?"primary":"default"},{default:s(()=>t[4]||(t[4]=[m(" English ")])),_:1,__:[4]},8,["type"]),a(d,{onClick:t[1]||(t[1]=u=>S("es")),type:D(v)==="es"?"primary":"default"},{default:s(()=>t[5]||(t[5]=[m(" EspaÃ±ol ")])),_:1,__:[5]},8,["type"])]),_:1})]),_:1}),c.value?(h(),b(K,{key:0,model:l.value,rules:N,"label-width":"120px",size:"large",ref_key:"formRef",ref:w},{default:s(()=>[I("h3",H,g(e.$t("settings.caretend")),1),a(k,{label:e.$t("settings.clientId"),path:"client_id"},{default:s(()=>[a($,{value:l.value.client_id,"onUpdate:value":t[2]||(t[2]=u=>l.value.client_id=u),placeholder:e.$t("settings.placeholderClientId")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(k,{label:e.$t("settings.secretKey"),path:"secret"},{default:s(()=>[a($,{value:l.value.secret,"onUpdate:value":t[3]||(t[3]=u=>l.value.secret=u),type:"password",placeholder:e.$t("settings.placeholderSecretKey"),"show-password-on":"click"},null,8,["value","placeholder"])]),_:1},8,["label"]),a(y,{justify:"end",class:"mt-4"},{default:s(()=>[a(d,{loading:_.value,type:"primary",onClick:V},{default:s(()=>[m(g(r.value?e.$t("settings.update"):e.$t("settings.save")),1)]),_:1},8,["loading"]),r.value?(h(),b(d,{key:0,type:"error",secondary:"",onClick:B},{default:s(()=>[m(g(e.$t("settings.delete")),1)]),_:1})):C("",!0)]),_:1})]),_:1},8,["model"])):C("",!0)]),_:1},8,["title"])}}},Q=T(L,[["__scopeId","data-v-93eee374"]]);export{Q as default};
