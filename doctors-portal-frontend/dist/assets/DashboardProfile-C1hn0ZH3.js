import{i as v}from"./axios-D3XPDuSg.js";import{u as y,y as $,r as n,e as P,f as k,w as i,g as o,s as N,h as _,o as U,j as s,z as B,C as u,D as p,B as C,n as F,t as I}from"./index-CaOXgG-J.js";const q={__name:"DashboardProfile",setup(M){const{t}=y(),d=$(),c=_(),m=n(null),f=n(!1),e=n({name:"",email:"",password:"",password_confirmation:""}),w={name:[{required:!0,message:t("profile.validation.name"),trigger:["input","blur"]}],email:[{required:!0,message:t("profile.validation.email"),trigger:["input","blur"]},{type:"email",message:t("profile.validation.invalidEmail"),trigger:["input","blur"]}],password:[{min:6,message:t("profile.validation.passwordMin"),trigger:["input","blur"]}],password_confirmation:[{validator:(a,l)=>l===e.value.password,message:t("profile.validation.passwordMatch"),trigger:["input","blur"]}]},g=n(null),h=async()=>{try{const l=(await v.get("/user")).data;g.value=l.id,e.value.name=l.name,e.value.email=l.email}catch(a){console.error("Failed to fetch user",a),d.error(t("profile.fetchError")),c.push("/login")}},b=async()=>{var a,l;try{f.value=!0,await((a=m.value)==null?void 0:a.validate());const r={name:e.value.name,email:e.value.email};e.value.password&&(r.password=e.value.password,r.password_confirmation=e.value.password_confirmation),await v.put("/user",r),d.success(t("profile.success")),e.value.password="",e.value.password_confirmation=""}catch(r){console.error("Failed to update profile",((l=r==null?void 0:r.response)==null?void 0:l.data)||r.message),d.error(t("profile.error"))}finally{f.value=!1}};return P(()=>{h()}),(a,l)=>(U(),k(o(N),{title:a.$t("profile.title")},{default:i(()=>[s(o(B),{ref_key:"formRef",ref:m,model:e.value,rules:w,"label-width":"120px",size:"large"},{default:i(()=>[s(o(u),{label:a.$t("profile.name"),path:"name"},{default:i(()=>[s(o(p),{value:e.value.name,"onUpdate:value":l[0]||(l[0]=r=>e.value.name=r),placeholder:a.$t("profile.placeholder.name")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o(u),{label:a.$t("profile.email"),path:"email"},{default:i(()=>[s(o(p),{value:e.value.email,"onUpdate:value":l[1]||(l[1]=r=>e.value.email=r),placeholder:a.$t("profile.placeholder.email")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o(u),{label:a.$t("profile.newPassword"),path:"password"},{default:i(()=>[s(o(p),{value:e.value.password,"onUpdate:value":l[2]||(l[2]=r=>e.value.password=r),type:"password",placeholder:a.$t("profile.placeholder.newPassword"),"show-password-on":"click"},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o(u),{label:a.$t("profile.confirmPassword"),path:"password_confirmation"},{default:i(()=>[s(o(p),{value:e.value.password_confirmation,"onUpdate:value":l[3]||(l[3]=r=>e.value.password_confirmation=r),type:"password",placeholder:a.$t("profile.placeholder.confirmPassword"),"show-password-on":"click"},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o(C),{type:"primary",loading:f.value,onClick:b},{default:i(()=>[F(I(a.$t("profile.update")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1},8,["title"]))}};export{q as default};
