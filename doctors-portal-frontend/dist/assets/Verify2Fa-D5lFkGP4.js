import{i as d}from"./axios-Ddd_rRZT.js";import{r as S,t as b,v as x,g as V,c as C,a as p,i as t,w as o,h as a,K as F,o as h,m as c}from"./index-BHWUVyN0.js";import{F as k}from"./FooterComponent-njJQCDBw.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"verify-wrapper"},R={__name:"Verify2Fa",setup(U){const i=V(),n=S(""),l=localStorage.getItem("2fa_user_id"),_=b(),s=x();l||i.push("/login");const f=async()=>{try{const r=await d.post("/verify-2fa",{code:n.value,user_id:l});localStorage.setItem("access_token",r.data.token),_.setUser(r.data.user),localStorage.removeItem("2fa_user_id"),localStorage.getItem("remember_me")!=="true"&&(localStorage.removeItem("remember_me_email"),localStorage.removeItem("remember_me_password"),localStorage.removeItem("remember_me")),s.success("Verification successful!"),i.push("/dashboard")}catch{s.error("Invalid or expired code")}},g=async()=>{try{await d.post("/resend-2fa",{user_id:l}),s.success("Code resent to your email")}catch{s.error("Failed to resend code")}};return(r,e)=>{const v=a("n-p"),y=a("n-input"),m=a("n-button"),u=a("n-space"),I=a("n-card");return h(),C(F,null,[p("div",N,[e[4]||(e[4]=p("img",{src:"https://deliveritpharmacy.com/wp-content/uploads/2024/04/Logo-Resurrgaction-B-Vertical.png",alt:"DeliverIt Logo",class:"logo"},null,-1)),t(I,{class:"verify-card",title:"Two-Factor Authentication"},{default:o(()=>[t(u,{vertical:"",size:"large",align:"center"},{default:o(()=>[t(v,null,{default:o(()=>e[1]||(e[1]=[c("Please enter the 6-digit code sent to your email:")])),_:1}),t(y,{value:n.value,"onUpdate:value":e[0]||(e[0]=w=>n.value=w),placeholder:"Enter code",maxlength:"6",style:{width:"200px"}},null,8,["value"]),t(u,null,{default:o(()=>[t(m,{type:"primary",onClick:f},{default:o(()=>e[2]||(e[2]=[c("Verify")])),_:1}),t(m,{tertiary:"",onClick:g},{default:o(()=>e[3]||(e[3]=[c("Resend Code")])),_:1})]),_:1})]),_:1})]),_:1})]),t(k)],64)}}},A=B(R,[["__scopeId","data-v-61625ceb"]]);export{A as default};
